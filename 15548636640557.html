<!DOCTYPE html>
<html>

<head>
    <title>
         Linux下Oracle彻底删除实例 - xiaobio 
    </title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Life it self">

    <link rel="stylesheet" type="text/css" href="asset/cuckoo.css">
    <link rel="stylesheet" type="text/css" href="asset/main.css">
    <link rel="stylesheet" type="text/css" href="asset/atom-one-light.css">

    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="xiaobio">

    <script src="asset/highlight.pack.js"></script>
<!--    <script>hljs.initHighlightingOnLoad();</script>-->
</head>

<body>
    <header class="site-header cuckoo">
        <div class="wrapper">
            <a class="site-title" href="index.html">xiaobio</a>
            <nav class="site-nav">
                <a href="#" class="menu-icon">
                    <svg viewBox="0 0 18 15">
                        <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
                        <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
                        <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
                    </svg>
                </a>
                <div class="trigger">
                    
                        <a class="page-link" href="index.html">Home</a>
                    
                        <a class="page-link" href="archives.html">Archives</a>
                    
                        <a class="page-link" href="about.html">About</a>
                    
                </div>
            </nav>
        </div>
    </header>
</body>

</html>
 <div class="page-content cuckoo">
    <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
            <header class="post-header">
                <h1 class="post-title" itemprop="name headline">Linux下Oracle彻底删除实例</h1>
                <div class="post-description">
                    
                </div>
            </header>
            <div class="post-content" itemprop="articleBody">
                <h2 id="toc_0">主要有两种方法，一般情况第一种方法可以实现</h2>

<h2 id="toc_1">方法一：用安装oracle的用户进行dbca</h2>

<p>图形界面执行<code>dbca</code>，从界面选择要删除的实例，按提示一步步执行即可，较简单！</p>

<h2 id="toc_2">方法二： dbca没有完全清除，需要其他操作来实现</h2>

<p>该方法数据库要处于<code>mount</code>状态，然后<code>alter system enable restricted session;</code></p>

<ul>
<li>执行步骤如下：</li>
</ul>

<pre class="line-numbers"><code class="language-sql">SQL&gt;shutdown abort;      ##关闭数据库
Database altered.
SQL&gt;startup mount;       #开启数据库到mount状态
SQL&gt; select status from v$instance;      #check数据库在mount状态
STATUS
------------
MOUNTED

SQL&gt; alter system enable restricted session;#
System altered.

SQL&gt; select status from v$instance;
STATUS
------------
MOUNTED

SQL&gt; drop database;
Database dropped.
</code></pre>

<span id="more"></span><!-- more -->

<p>此时alert.log记录信息：</p>

<pre class="line-numbers"><code class="language-text">Create Relation ADR_CONTROL
Create Relation ADR_INVALIDATION
Create Relation INC_METER_IMPT_DEF
Create Relation INC_METER_PK_IMPTS
USER (ospid: 8748): terminating the instance
Instance terminated by USER, pid = 8748
Deleted Oracle managed file /opt/app/ora11g/oradata/daily/controlfile/o1_mf_9x4fgq77_.ctl
Deleted Oracle managed file /opt/app/ora11g/flash_recovery_area/daily/controlfile/o1_mf_9x4fgypb_.ctl
Completed: drop database
Shutting down instance (abort)
License high water mark = 2
Fri Jul 25 19:09:26 2014
Instance shutdown complete
</code></pre>

<p>到<code>oradata</code>路径下看已经没有任何文件了，那么认为这个数据库已经被删除。<br/>
但再次执行dbca，创建相同实例的库时还会报错！因为虽然和daily实例关联的数据文件、日志文件等已经物理删除了，但和这实例相关的配置文件没有删除、<br/>
所以此时需要手工删除实例相关的配置：</p>

<ol>
<li>删除\(ORACLE_BASE/admin/\)ORACLE_SID所有目录。</li>
<li>删除$ORACLE_HOME/dbs下和SID相关的文件和参数文件，包括hc_daily.dat，init.ora，lkDAILY，orapwdaily。</li>
<li>删除/etc/oratab中和实例相关的部分。</li>
<li>可以在$ORACLE_HOME中执行find . -name daily，删除所有和实例相关的文件。</li>
</ol>

<p>删除结束后，再用安装oracle的用户进行<code>dbca</code>创建同名的数据库即可！</p>

            </div>
            <div>
                
                
                
            </div>
        </article>
    </div>
</div>

<script src="asset/jquery-3.3.1.min.js"></script>

<script>
    $(document).ready(function() {
        $('#footer').show()
    })
</script>
  <footer id="footer" class="cuckoo page-footer" style="display: none">
    <div class="wrapper">
        <p>Designed and Written by <a href="mailto:forrestchang7@gmail.com">Jiayuan Zhang</a></p>
    </div>
</footer>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

