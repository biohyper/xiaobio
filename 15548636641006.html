<!DOCTYPE html>
<html>

<head>
    <title>
         鼠须管教 - xiaobio 
    </title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Life it self">

    <link rel="stylesheet" type="text/css" href="asset/cuckoo.css">
    <link rel="stylesheet" type="text/css" href="asset/main.css">
    <link rel="stylesheet" type="text/css" href="asset/atom-one-light.css">

    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="xiaobio">

    <script src="asset/highlight.pack.js"></script>
<!--    <script>hljs.initHighlightingOnLoad();</script>-->
</head>

<body>
    <header class="site-header cuckoo">
        <div class="wrapper">
            <a class="site-title" href="index.html">xiaobio</a>
            <nav class="site-nav">
                <a href="#" class="menu-icon">
                    <svg viewBox="0 0 18 15">
                        <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
                        <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
                        <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
                    </svg>
                </a>
                <div class="trigger">
                    
                        <a class="page-link" href="index.html">Home</a>
                    
                        <a class="page-link" href="archives.html">Archives</a>
                    
                        <a class="page-link" href="about.html">About</a>
                    
                </div>
            </nav>
        </div>
    </header>
</body>

</html>
 <div class="page-content cuckoo">
    <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
            <header class="post-header">
                <h1 class="post-title" itemprop="name headline">鼠须管教</h1>
                <div class="post-description">
                    
                </div>
            </header>
            <div class="post-content" itemprop="articleBody">
                <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=31445772&auto=0&height=32"></iframe>

<h2 id="toc_0">综述</h2>

<p><strong>Rime</strong>输入法在<a href="http://rime.im">官网</a>已经介绍很清楚，这里轻微搬运。Rime输入法全平台支持，只不过称呼不同而已，对应名称如下：</p>

<ul>
<li>Mac：「鼠须管」 <code>Squirrel</code></li>
<li>Linux：「中州韻」 <code>ibus-rime</code></li>
<li>Windows：「小狼毫」 <code>Weasel</code></li>
</ul>

<p>Rime输入法的特点在于<strong><em>完全自定义</em></strong>，不用担心广告，不用担心泄漏用户数据，自己决定要如何输入，且可以针对不用应用开启不同输入方案；当你决定要使用Rime输入法的时候，就证明你对输入法的要求与众不同咯 😂😂下面就正式开始作死！！</p>

<span id="more"></span><!-- more -->

<hr/>

<p><strong><em>折腾前</em></strong><br/>
个人觉得折腾鼠须管要先确认好自己的需求，个人想法主要为了实现中文状态下<strong>半角符号</strong>快速上屏，思路仅供参考：</p>

<ul>
<li>将配置快捷键调整好，不论使用默认还是自定义，要先确定好，方便后续调整</li>
<li>外观调整为自己常用样式，这样看起来不会太累</li>
<li>实现自己的目的，如符号快速上屏等</li>
<li>扩充词库</li>
<li>备份配置以及词库</li>
</ul>

<hr/>

<h2 id="toc_1">本次配置目的</h2>

<p><strong>本次配置针对朙月拼音<code>luna_pinyin</code>最终可以实现以下目的：</strong></p>

<ul>
<li><code>#</code>号等符号快速上屏，尤其针对使用<code>Markdown</code>语法书写的同志；</li>
<li><p>皮肤及字体优化，效果如下：<br/>
<figure><img src="http://oninp1nwo.bkt.clouddn.com/fipu.jpg" alt="皮肤"/><figcaption>皮肤</figcaption></figure></p></li>
<li><p>实现类似macOS的中英文切换方式，通过大写锁定切换；<em>因个人将<code>⇪capslock</code>键与<code>⌃control</code>交换，且习惯<code>⇧shift</code>键输入大写字母，所以对<code>⇪</code>键需求不大</em></p></li>
<li><p>修改候选字翻页设置，保留<code>Windows</code>习惯用<code>+</code><code>-</code>切换，增加<code>Mac</code>的方括号<code>[</code><code>]</code>切换；修改<code>control + d</code>调用方案切换</p></li>
<li><p>配置及数据文件同步到<code>Dropbox</code>等云盘</p></li>
</ul>

<h2 id="toc_2">基本思路</h2>

<p><strong>一切以配置文件为中心</strong></p>

<p>Rime之所以可以高度自定义，是因为配置文件以及词库文件可以任意修改，只需遵循<code>YAML</code>语法就好。本人使用Mac平台，主要介绍鼠须管，配置文件基本通用的。鼠须管配置文件和数据文件存放在同一个路径<code>~/Library/Rime/</code>，也可以通过状态栏的<strong>用户设置</strong>或<code>Settings</code>打开该路径。  </p>

<p>该路径下第一次安装后会自动部署一次，产生默认的配置以及数据文件(还有写提高执行效率的编译文件，配置不需要用到)，我们需要注意的是以<code>*.dict.yaml</code>和<code>*.yaml</code>结尾的文件，有<code>dict</code>的是词库文件，后者就是我们用来自定义的主要配置(<code>dict</code>词库配置下次补充)。</p>

<blockquote>
<p>一定注意，文件要自己新建用户自定义配置，莫要修改原有文件，否则升级将会覆盖原有文件，不宜备份，也防止修改异常容易恢复<br/>
<strong>自定义文件必须在文件顶部输入<code>patch：</code>，有且只有一个</strong></p>
</blockquote>

<p><strong>本次鼠须管自定义配置主要文件如下：</strong></p>

<ul>
<li>全局配置文件: <code>default.custom.yaml</code></li>
<li>皮肤配置文件: <code>squirrel.custom.yaml</code></li>
<li>输入方案配置: <code>&lt;user plan&gt;.custom.yaml</code>, 例如我自己使用<code>luna_pinyin.custom.yaml</code></li>
<li>安装配置文件：<code>installation.yaml</code>，可配置同步到本地、U盘、云盘等路径</li>
</ul>

<h2 id="toc_3">全局配置文件</h2>

<p><strong>该文件<code>default.custom.yaml</code>主要配置全局输入选项,例如候选字数、如何切换输入方案等，默认通过「control + `」调出切换方案功能</strong><br/>
　<figure><img src="http://oninp1nwo.bkt.clouddn.com/fipu.jpg" alt="切换"/><figcaption>切换</figcaption></figure></p>

<pre class="line-numbers"><code class="language-yaml"># Rime default settings
# encoding: utf-8
patch:
  config_version: &quot;0.37&quot;
# 切换中英文配置
  ascii_composer:
    good_old_caps_lock: false
    switch_key:
      Shift_L: noop
      Shift_R: noop
      Control_L: noop
      Control_R: noop
      Caps_Lock: commit_code
      Eisu_toggle: clear

# 输入方案选择
  schema_list:
    - schema: luna_pinyin
    # - schema: terra_pinyin
    # - schema: bopomofo
    # - schema: emoji
    # - schema: bopomofo_tw
    # - schema: cangjie5
    # - schema: stroke
    # - schema: luna_pinyin_simp
    # - schema: luna_pinyin_fluency

# 输入方案切换方式
  switcher:
    caption: 〔切换方案〕
    hotkeys:
      - Control+grave
      - Control+Shift+grave
      - Control+d
    save_options:
      - full_shape
      - ascii_punct
      - simplification
      - extended_charset
    fold_options: true
    abbreviate_options: true
    option_list_separator: &#39;／&#39;

# 候选字数量
  menu:
    page_size: 9

# 按键绑定，方括号翻页
  key_binder:
    bindings:
      # Emacs style
      - { when: composing, accept: Control+p, send: Up }
      - { when: composing, accept: Control+n, send: Down }
      - { when: composing, accept: Control+b, send: Left }
      - { when: composing, accept: Control+f, send: Right }
      - { when: composing, accept: Control+a, send: Home }
      - { when: composing, accept: Control+e, send: End }
      - { when: composing, accept: Control+d, send: Delete }
      - { when: composing, accept: Control+k, send: Shift+Delete }
      - { when: composing, accept: Control+h, send: BackSpace }
      - { when: composing, accept: Control+g, send: Escape }
      - { when: composing, accept: Control+bracketleft, send: Escape }
      - { when: composing, accept: Alt+v, send: Page_Up }
      - { when: composing, accept: Control+v, send: Page_Down }
      # move by word
      - { when: composing, accept: ISO_Left_Tab, send: Shift+Left }
      - { when: composing, accept: Shift+Tab, send: Shift+Left }
      - { when: composing, accept: Tab, send: Shift+Right }
      # flip page
      - { when: has_menu, accept: minus, send: Page_Up }
      - { when: has_menu, accept: equal, send: Page_Down }
      - { when: paging, accept: bracketleft, send: Page_Up }    # 方括号‘[’翻上一页
      - { when: has_menu, accept: bracketright, send: Page_Down }    # 方括号‘]’翻下一页
      # hotkey switch
      - { when: always, accept: Control+Shift+1, select: .next }
      - { when: always, accept: Control+Shift+2, toggle: ascii_mode }
      - { when: always, accept: Control+Shift+3, toggle: full_shape }
      - { when: always, accept: Control+Shift+4, toggle: simplification }
      - { when: always, accept: Control+Shift+5, toggle: extended_charset }
      - { when: always, accept: Control+Shift+exclam, select: .next }
      - { when: always, accept: Control+Shift+at, toggle: ascii_mode }
      - { when: always, accept: Control+Shift+numbersign, toggle: full_shape }
      - { when: always, accept: Control+Shift+dollar, toggle: simplification }
      - { when: always, accept: Control+Shift+percent, toggle: extended_charset }
      - { when: always, accept: Shift+space, toggle: full_shape }
      - { when: always, accept: Control+period, toggle: ascii_punct }

# 特殊字符快速上屏
  punctuator:
    full_shape:
      &#39; &#39; : { commit: &#39;　&#39; }
      &#39;,&#39; : { commit: ， }
      &#39;.&#39; : { commit: 。 }
      &#39;&lt;&#39; : [ 《, 〈, «, ‹ ]
      &#39;&gt;&#39; : [ 》, 〉, », › ]
      &#39;/&#39; : [ ／, ÷ ]
      &#39;?&#39; : { commit: ？ }
      &#39;;&#39; : { commit: ； }
      &#39;:&#39; : { commit: ： }
      &#39;&#39;&#39;&#39; : { pair: [ &#39;‘&#39;, &#39;’&#39; ] }

    half_shape:
      &#39;/&#39; : [ 、, ､, &#39;/&#39;, ／, ÷ ]
      &#39;?&#39; : { commit: ？ }
      &#39;;&#39; : { commit: ； }
      &#39;:&#39; : { commit: ： }
      &#39;&#39;&#39;&#39; : { pair: [ &#39;‘&#39;, &#39;’&#39; ] }
      &#39;&quot;&#39; : { pair: [ &#39;“&#39;, &#39;”&#39; ] }
      &#39;\&#39; : [ 、, &#39;\&#39;, ＼ ]
      &#39;|&#39; : [ ·, ・, &#39;|&#39;, ｜, &#39;§&#39;, &#39;¦&#39;, &#39;‖&#39; ]
      &#39;!&#39; : { commit: ！ }
      &#39;@&#39; : [ &#39;@&#39;, ©, ®, ℗ ]
      &#39;#&#39; : &#39;#&#39;
      &#39;%&#39; : [ &#39;%&#39;, ％, &#39;°&#39;, &#39;℃&#39;, ‰, ‱, ℉ ]

# 邮件等智能输入
  recognizer:
    patterns:
      email: &quot;^[A-Za-z][-_.0-9A-Za-z]*@.*$&quot;
      uppercase: &quot;[A-Z][-_+.&#39;0-9A-Za-z]*$&quot;
      url: &quot;^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$&quot;
      punct: &quot;^/([0-9]0?|[a-z]+)$&quot;
</code></pre>

<h2 id="toc_4">皮肤配置文件</h2>

<p><strong>该文件<code>squirrel.custom.yaml</code>配置输入法皮肤样式，如配色等</strong><br/>
示例配置为自己常用配置，仅供参考，<code>squirrel.yaml</code>中有默认主题可供选择，只需修改以下内容</p>

<pre class="line-numbers"><code class="language-text">style:
    color_scheme: apathy
</code></pre>

<p>候选词条中如果出现生显示框问号，代表缺少生僻字字体，可以在方案配色的字体指向上多加一个花园明朝<code>HanaMinA</code>字体，文件示例如下：</p>

<pre class="line-numbers"><code class="language-yaml">patch:
  us_keyboard_layout: false
  
  # options: always | never | appropriate
  show_notifications_when: appropriate  # 状态通知，适当(appropriate)，开（always）关（never）
  
  # Show notifications via Notification Center instead of Growl.

  show_notifications_via_notification_center: true
  
  style:
    color_scheme: bio
    horizontal: true        # 水平排列
    inline_preedit: false   # 单行显示，false双行显示
    corner_radius: 5        # 候选条圆角
    border_height: 0
    border_width: 0
    line_spacing: 0.2
    spacing: 2              # space between preedit and candidates in non-inline mode
    # candidate_format: &#39;%c. %@&#39;                # 编号 %c 和候选词 %@ 前后的空间
    font_face: &#39;Yuanti SC Regular,HanaMinA&#39;    # 候选词字体 supporting soft cursor &#39;›&#39;
    font_point: 14          # 候选字词大小
    # label_font_face: &#39;STHeitiTC-Medium&#39;   # 候选词编号字体
    # label_font_point: 18                  # 候选编号大小
  
  preset_color_schemes:
    bio:
      name: &quot;bio/Dark&quot;
      back_color: 0xee303030         #候选条背景色
      candidate_text_color: 0xd8e3e6   
      comment_text_color: 0x606cff     # 拼音等提示文字颜色 
      hilited_candidate_back_color: 0x19303030  # 候选文字背景色
      hilited_candidate_text_color: 0x92ff00    # 候选文字颜色
      hilited_text_color: 0xffcf9a
      text_color: 0x92f6da       # 高亮选中词颜色
</code></pre>

<h2 id="toc_5">输入方案配置文件</h2>

<p><strong>该文件<code>luna_pinyin.custom.yaml</code>确认当前方案的自定义和配置</strong></p>

<pre class="line-numbers"><code class="language-yaml"># Rime schema
# encoding: utf-8
patch:
  schema:
    schema_id: luna_pinyin
    name: 朙月拼音
    version: &quot;0.23&quot;
    dependencies:
      - emoji
      - symbols
  
  switches:
    - name: ascii_mode
      reset: 0
      states: [ 中文, 西文 ]
    - name: full_shape
      states: [ 半角, 全角 ]
    - name: simplification
      states: [ 漢字, 汉字 ]
    - name: ascii_punct
      states: [ 。，, ．， ]
  
  engine:
    processors:
      - ascii_composer
      - recognizer
      - key_binder
      - speller
      - punctuator
      - selector
      - navigator
      - express_editor
    segmentors:
      - ascii_segmentor
      - matcher
      - abc_segmentor
      - punct_segmentor
      - fallback_segmentor
    translators:
      - punct_translator
      - reverse_lookup_translator
      - script_translator
    filters:
      - simplifier
      - uniquifier
  
  speller:
    alphabet: zyxwvutsrqponmlkjihgfedcba
    delimiter: &quot; &#39;&quot;
    algebra:
      - erase/^xx$/
      - abbrev/^([a-z]).+$/$1/
      - abbrev/^([zcs]h).+$/$1/
      - derive/^([nl])ve$/$1ue/
      - derive/^([jqxy])u/$1v/
      - derive/un$/uen/
      - derive/ui$/uei/
      - derive/iu$/iou/
      - derive/([aeiou])ng$/$1gn/
      - derive/([dtngkhrzcs])o(u|ng)$/$1o/
      - derive/ong$/on/
      - derive/ao$/oa/
      - derive/([iu])a(o|ng?)$/a$1$2/
  
  translator:
    dictionary: biohyper      # 词库选择，我此处用自己新建的配置
    preedit_format:
      - xform/([nljqxy])v/$1ü/
      - xform/([nl])ue/$1üe/
      - xform/([jqxy])v/$1u/
  
  custom_phrase:
    dictionary: &quot;&quot;
    user_dict: custom_phrase
    db_class: stabledb
    enable_completion: false
    enable_sentence: false
    initial_quality: 1
  
  reverse_lookup:
    reredictionary: emoji
    rereenable_completion: false
    rereprefix: &quot;~&quot;
    tips: [emoji]
  punctuator:              # 自定义特殊符号词库文件
    import_preset: symbols

  key_binder:              # 按键绑定采用`default.yaml`文件
    import_preset: default

  recognizer:
    import_preset: default
    patterns:
      punct: &quot;^/([0-9]0?|[a-z]+)$&quot;       # 通过输入`/dn`等以`/`开头加字母可以输入特殊符号
      reverse_lookup: &quot;~[a-z]*&#39;?$&quot;
</code></pre>

<h2 id="toc_6">备份词库以及配置文件</h2>

<p>通过修改<code>installation.yaml</code>文件可以实现备份功能，通过状态栏的同步功能可实现自动同步，配置文件如下：</p>

<pre class="line-numbers"><code class="language-yaml">distribution_code_name: Squirrel
distribution_name: &quot;鼠鬚管&quot;
distribution_version: 0.9.26.2
install_time: &quot;Fri Mar 24 22:20:10 2017&quot;
installation_id: &quot;`userdefine`&quot;
rime_version: 1.2.9
sync_dir: &quot;/Users/`username`/Dropbox/Rime&quot;    # 个人网盘路径
</code></pre>

<h2 id="toc_7">结尾</h2>

<p>参考了好多帖子才搞清楚大概，这里做个记录。<br/>
上文用到的配置文件有部分配置直接从默认配置copy过来，并非自定义配置，详细可以查看<a href="https://github.com/rime/home/wiki/RimeWithSchemata#%E9%97%9C%E6%96%BC%E8%AA%BF%E8%A9%A6">官网配置</a>以及作者<a href="https://gist.github.com/lotem">示例配置</a>。<br/>
<a href="http://fonts.jp/hanazono/">花园明朝</a>字体<a href="https://www.dropbox.com/s/3sqipigs1liszao/HanaMinA.ttf?dl=0"><code>Dropbox</code>分享</a></p>

            </div>
            <div>
                
                
                
            </div>
        </article>
    </div>
</div>

<script src="asset/jquery-3.3.1.min.js"></script>

<script>
    $(document).ready(function() {
        $('#footer').show()
    })
</script>
  <footer id="footer" class="cuckoo page-footer" style="display: none">
    <div class="wrapper">
        <p>Designed and Written by <a href="mailto:forrestchang7@gmail.com">Jiayuan Zhang</a></p>
    </div>
</footer>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

